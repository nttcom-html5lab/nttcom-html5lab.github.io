var util=function(){var n=function(){return"now"in Date?Date.now():new Date},o=navigator.userAgent.toLowerCase(),e=!0,t=/android/.test(o),i=/mobile/.test(o),r={iPhone:/iphone/.test(o),iPad:/ipad/.test(o),iPod:/ipod/.test(o),smartphone:t&&i,tablet:t&&!i},s=$("body").get(0).style,a={console:!(!window.console||!console.log),touch:"ontouchstart"in window,video:"HTMLVideoElement"in window,transform:"-webkit-transform"in s&&"-webkit-transform"||"-moz-transform"in s&&"-moz-transform"||"-ms-transform"in s&&"-ms-transform"||"-o-transform"in s&&"-o-transform"||"transform"in s&&"transform"},_={iOS:r.iPhone||r.iPad||r.iPod,android:t};if(_.iOS){var l=o.match(/os ([\d_]+)/);l&&l.length>1&&(_.version=l[1].replace("_","."))}var d={ie:/(trident|msie)/.test(navigator.userAgent.toLowerCase())};if(d.ie){var m=o.match(/(msie |rv:)([\d\.]+)/);m&&m.length>2&&(d.version=m[2])}var u=d.ie&&/^9/.test(d.version);if(a.inlineVideo=a.video&&!r.iPhone&&!r.iPod&&!r.smartphone&&!u,_.iOS){var h=/^[^2-6]/.test(_.version);if(h){var v=window.innerHeight,w=setInterval(function(){var n=window.innerHeight;v!==n&&(v=n,$(window).trigger("iosstatusbarvisibilitychange"))},1e3);$(window).on("unload",function(){clearInterval(w)})}}return a.console&&console.log("\n _   _  _____  __  __  _     ___    _       _    ___\n| |_| ||_   _||  \\/  || |   | __|  | |     / \\  | D )\n|  _  |  | |  | |\\/| || |__ |__ \\  | |__  / A \\ | D \\\n|_| |_|  |_|  |_|  |_||____||___/  |____|/_/¯\\_\\|___/\n\n         N T T   C o m m u n i c a t i o n s\n\nHi! Thank you for looking in the developer console!\nIf you have any cool ideas or see any bugs,\nplease submit a pull request.\n\nコンソールまで見てくれてありがとう！\nおもしろいアイデアや不具合などあれば、プルリクエストを送ってくださいね。\n\nhttps://github.com/html5lab/html5lab.github.io/"),{getNow:n,isDebug:e&&a.console,support:a,os:_,browser:d}}();
var flexvideo=function(){function t(t,e,n){function o(t){this.emit(t.originalEvent.type)}return util.isDebug&&console.log("flexvideo.initialize()"),h=$(t),g=$(e),m=g.get(0),util.support.transform?g.css({width:k+"px",height:z+"px"}):h.find("img").css({width:"100%",height:"100%"}),y.on("resize iosstatusbarvisibilitychange",i),i(),util.support.inlineVideo?void g.on("loadedmetadata",$.proxy(function(t){R=m.duration,this.emit(t.originalEvent.type)},this)).on("loadeddata",$.proxy(o,this)).on("timeupdate",$.proxy(o,this)).on("ended",$.proxy(o,this)).on("playing",$.proxy(o,this)).on("pause",$.proxy(function(){this.emit("paused")},this)):(v=$(n),v.show(),R=v.attr("data-duration")-0,v.find("img").each(function(){O.push($(this).attr("data-sec")-0)}),O.sort(function(t,i){return t-i}),void setTimeout($.proxy(function(){this.emit("loadedmetadata"),setTimeout($.proxy(function(){this.emit("loadeddata")},this),0)},this),0))}function i(t){function i(t,i){switch(i){case"translate":var e=arguments[2],n=arguments[3];util.support.transform?t.transform=(t.transform?t.transform+" ":"")+"translate("+e+"px, "+n+"px)":(t.left=e+"px",t.top=n+"px");break;case"scale":var o=arguments[2];util.support.transform?t.transform=(t.transform?t.transform+" ":"")+"scale("+o+")":(t.width=k*o+"px",t.height=z*o+"px")}}if(t&&t.type&&console.log("window.on"+t.type),U)var e=window.innerWidth,n=window.innerHeight;else var e=y.width(),n=y.height();var o={},r=0,u=0;e/n>k/z?(r=(n-e*z/k)/2,i(o,"translate",0,r),u=e/k,i(o,"scale",u)):(r=(e-n*k/z)/2,i(o,"translate",r,0),u=n/z,i(o,"scale",u)),h.css(o)}function e(t,i){return $(this).on(t,i),this}function n(t,i){return $(this).off(t,i),this}function o(t,i){return $(this).trigger(t,i),this}function r(){return util.isDebug&&console.log("flexvideo.play()"),util.support.inlineVideo?m.seeking?(util.isDebug&&console.log("waiting for playing"),I++<N?void setTimeout(r,_):void(util.isDebug&&console.log("waiting for playing time out"))):(I=0,void m.play()):(B=util.getNow(),S=setInterval($.proxy(f,this),F),void this.emit("playing"))}function u(){return util.isDebug&&console.log("flexvideo.pause()"),util.support.inlineVideo?void m.pause():(S&&(clearInterval(S),S=0),void this.emit("paused"))}function s(){return R}function a(t){function i(){for(var i=-1,e=O.length,n=0;e>n;n++)if(O[n]>t){i=n-1;break}return-1===i&&(i=e-1),i}function e(t,i,e,n){var o=v.find("img[data-sec="+O[t]+"]");i&&(o.attr("src")||o.attr("src",o.attr("data-src"))),e&&o.show(),n&&o.hide()}if(!util.support.inlineVideo){var n=O.length,o=i();return(0===C||G!==o)&&(e(G,!1,!1,!0),e(o,!0,!0,!1),n-1>o?(M=o+1,e(M,!0,!1,!1)):M=o,util.isDebug&&console.log("change picture "+o),G=o),C=t,this.emit("timeupdate"),void(t>=R&&(clearInterval(S),S=0,this.emit("ended")))}m.currentTime=t}function l(){return util.support.inlineVideo?m.currentTime:C}function d(){return util.support.inlineVideo?m.readyState:-1===R?w:A}function p(){return util.support.inlineVideo?m.ended:C>=R}function f(){var t=util.getNow(),i=Math.min(C+(t-B)/1e3,R);B=t,$.proxy(a,this)(i)}function c(){return util.support.inlineVideo?m.buffered:{length:1,start:function(){return O[G]},end:function(){return O[M]}}}var h,g,m,v,y=$(window),w=0,x=1,V=2,T=3,A=4,b=1280,E=720,D=960,H=540,_=100,N=50,I=0,R=-1;if(util.os.iOS)var U=/^[^2-6]/.test(util.os.version);var k=util.support.inlineVideo?b:D,z=util.support.inlineVideo?E:H;if(!util.support.inlineVideo)var C=-1,O=[],S=0,G=0,M=0,B=util.getNow(),F=200;return util.support.inlineVideo||$(window).on("beforeunload",function(){S&&(clearInterval(S),S=0)}),{HAVE_NOTHING:w,HAVE_METADATA:x,HAVE_CURRENT_DATA:V,HAVE_FUTURE_DATA:T,HAVE_ENOUGH_DATA:A,initialize:t,on:e,off:n,emit:o,play:r,pause:u,getDuration:s,setCurrentTime:a,getCurrentTime:l,getReadyState:d,getEnded:p,getBuffered:c}}();
var bgv=function(){function e(){util.isDebug&&console.log("document.onready"),flexvideo.on("loadedmetadata",i).on("loadeddata",t).on("timeupdate",f).on("ended",l).on("playing",s).on("paused",u).initialize(".toppage-background","#video","#pictures"),M.addClass("isPausing"),util.isDebug&&$("main").append('<section class="current-time-container"><span id="currentTime"></span> / <span id="duration"></span></section>'),util.support.inlineVideo?$("#pictures").hide():$("#video").hide()}function i(){if(util.isDebug&&console.log("flexvideo.onloadedmetadata"),flexvideo.pause(),X=flexvideo.getDuration(),util.isDebug){var e=(Math.floor(10*X)/10).toFixed(1);$("#duration").text(e+"s")}}function o(){util.isDebug&&console.log("window.onload"),P=!0,P&&S&&n()}function t(){util.isDebug&&console.log("flexvideo.onloadeddata"),S=!0,P&&S&&n()}function n(){util.isDebug&&console.log("bgv.initialize()"),setTimeout(function(){R=!0,d(),D()},0)}function l(){util.isDebug&&console.log("flexvideo.onended"),y()}function s(){util.isDebug&&console.log("flexvideo.onplaying"),V=!0,util.isDebug&&console.log("isPlaying = true"),$("html").removeClass("isPausing").addClass("isPlaying")}function u(){util.isDebug&&console.log("flexvideo.onpaused"),I||($("html").removeClass("isPlaying").addClass("isPausing"),V=!1,util.isDebug&&console.log("isPlaying = false"))}function a(){P&&S&&(clearTimeout(C),C=setTimeout(d,100))}function d(){B=Y?window.innerHeight:$(window).height(),N=E.scrollTop()||M.scrollTop(),q=k.height(),util.isDebug&&console.log("bgv.measureSizes(); documentHeight = "+q+", windowHeight = "+B+", currentScroll = "+N),c()}function r(e){util.isDebug&&e&&e.type&&console.log("document.on"+e.type),V&&y()}function c(){if(!V){if(flexvideo.getReadyState()===flexvideo.HAVE_NOTHING)return void(util.isDebug&&console.warn("ignored scroll event because of readyState is "+flexvideo.getReadyState()));if(I)return void(util.isDebug&&console.warn("scroll event was fired though isSuspended is true."));if(!R)return void(util.isDebug&&console.warn("ignored scroll event because isInitialized is false."));util.isDebug&&console.log("window.onscroll"),g()}}function g(){N=E.scrollTop()||M.scrollTop();var e=X*N/(q-B);e=Math.max(Math.min(e,X),0),util.isDebug&&console.log("flexvideo.setCurrentTime("+e+")"),flexvideo.setCurrentTime(e),p(e)}function f(){return I?void(util.isDebug&&console.warn("timeupdate event was fired though isSuspended is true.")):V?util.support.touch&&F?(util.isDebug&&console.log("ignored timeupdate event because of first play."),void(F=!1)):(util.isDebug&&console.log("video.ontimeupdate"),void v()):void(util.isDebug&&console.log("ignored timeupdate event because isPlaying is false."))}function v(){var e=flexvideo.getCurrentTime(),i=(q-B)*e/X;util.isDebug&&console.log("html / body.scrollTop("+i+")"),z.stop(!0,!1).animate({scrollTop:i},{duration:400,easing:"linear"}),p(e)}function p(e){var i=(Math.floor(10*e)/10).toFixed(1),o=flexvideo.getBuffered(),t=o.length,n=$(".buffered"),l=n.length;util.isDebug&&$("#currentTime").text(i),$("#played").css({width:e/X*100+"%"});for(var s=0;s<Math.max(t,l);s++)if(t>s){s>=l&&$('<div class="buffered"></div>').appendTo(".seek-bar");var u=o.start(s),a=o.end(s);n.eq(s).css({left:u/X*100+"%",width:(a-u)/X*100+"%"})}else n.eq(s).css({width:0})}function b(e){switch(util.isDebug&&e.type&&(e.target&&e.target.nodeName?console.log(e.target.nodeName+".on"+e.type):e.target===window&&console.log("window.on"+e.type)),e.type){case"pageshow":I=!1;break;case"pagehide":I=!0;break;case"visibilitychange":switch(document.visibilityState){case"visible":I=!1;break;case"hidden":case"pretender":I=!0}}I!==O&&(O=I,util.isDebug&&console.log("isSuspended = "+I+", isPlaying = "+V),V&&I&&(z.stop(!0,!0),flexvideo.pause()),!V||I||w()||setTimeout($.proxy(flexvideo.play,flexvideo),0))}function h(e){util.isDebug&&console.log("#playButton.onclick"),e.preventDefault(),V||D()}function m(e){util.isDebug&&console.log("#pauseButton.onclick"),e.preventDefault(),V&&y()}function D(){util.isDebug&&console.log("bgv.startPlaying()"),w()||flexvideo.play()}function y(){util.isDebug&&console.log("bgv.stopPlaying()"),flexvideo.pause(),z.stop(!0,!0)}function w(){var e=flexvideo.getCurrentTime(),i=util.support.inlineVideo&&util.browser.ie;return flexvideo.getEnded()||-1===X&&e>=X||-1===X&&i&&.5>X-e}function x(e){A=e.originalEvent.touches[0].pageX,G=e.originalEvent.touches[0].pageY}function T(e){if(-1!==A){var i=e.originalEvent.touches[0].pageX,o=e.originalEvent.touches[0].pageY,t=Math.sqrt(Math.pow(A-i,2)+Math.pow(G-o,2));t>10&&(A=-1,G=-1,k.trigger("vwheel"))}}function H(){util.isDebug&&console.log("document.ontouchend"),A=-1,G=-1}var P=!1,S=!1,C=null,k=$(document),M=$("html"),E=$("body"),z=$("html, body"),B=0,N=0,q=0,V=!1,F=!0,I=!1,O=!1,R=!1,X=0;if(util.os.iOS)var Y=/^[^2-6]/.test(util.os.version);var A=-1,G=-1;return{readyHandler:e,windowLoadHandler:o,scrollHandler:c,resizeHandler:a,wheelHandler:r,visibilityChangeHandler:b,clickedPlayButtonHandler:h,clickedPauseButtonHandler:m,touchStartHandler:x,touchMoveHandler:T,touchEndHandler:H}}();
!function(){var o=$(document);util.support.touch&&o.on("touchstart",bgv.touchStartHandler).on("touchmove",bgv.touchMoveHandler).on("touchend touchcancel",bgv.touchEndHandler),o.on("mousewheel DOMMouseScroll vwheel mousedown",bgv.wheelHandler),o.on("visibilitychange",bgv.visibilityChangeHandler).on("ready",function(){$("#playButton").on("click touchstart",bgv.clickedPlayButtonHandler),$("#pauseButton").on("click touchstart",bgv.clickedPauseButtonHandler),bgv.readyHandler()}),$(window).on("load",bgv.windowLoadHandler).on("scroll",bgv.scrollHandler).on("resize iosstatusbarvisibilitychange",bgv.resizeHandler).on("pageshow load",bgv.visibilityChangeHandler).on("pagehide blur",bgv.visibilityChangeHandler)}();